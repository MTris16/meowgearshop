{{ define "main" }}
<div class="login-container">
    <div class="login-box">
        <h2>Đăng nhập / Đăng ký</h2>
        <p>Chào mừng bạn đến với Meow Gear</p>

        <button id="btnLoginGoogle" class="btn-social btn-google">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48">
                <path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"/>
                <path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"/>
                <path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"/>
                <path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"/>
            </svg>
    Tiếp tục với Google
        </button>

        <button class="btn-social btn-facebook" onclick="alert('Cần setup App ID Facebook trước!')">
            <img src="https://upload.wikimedia.org/wikipedia/commons/b/b8/2021_Facebook_icon.svg" alt="F">
            Tiếp tục với Facebook
        </button>
        
        <div id="login-message" style="color: red; margin-top: 10px;"></div>
    </div>
</div>

<style>
    .login-container { display: flex; justify-content: center; align-items: center; min-height: 60vh; background: #f5f5f5; padding: 20px; }
    .login-box { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 400px; text-align: center; }
    .login-box h2 { margin-bottom: 10px; color: #333; }
    .btn-social { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px; background: white; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; font-weight: bold; font-size: 15px; transition: 0.2s; }
    .btn-social:hover { background: #f9f9f9; }
    .btn-social img { width: 20px; height: 20px; }
    .btn-facebook { background: #1877F2; color: white; border: none; }
    .btn-facebook:hover { background: #166fe5; }
</style>

<script type="module">
  // 1. Import thư viện Firebase từ trên mạng
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyCR18C2YZzL86Fobw6KEjV2Grud6DbWpR4",
  authDomain: "meowgear-auth.firebaseapp.com",
  projectId: "meowgear-auth",
  storageBucket: "meowgear-auth.firebasestorage.app",
  messagingSenderId: "137799454592",
  appId: "1:137799454592:web:292a27966b41647229bb65",
  measurementId: "G-2CPHEXVFKE"
};

  // 3. Khởi chạy Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  // 4. Xử lý khi bấm nút Google
  document.getElementById('btnLoginGoogle').addEventListener('click', () => {
      signInWithPopup(auth, provider)
        .then((result) => {
            // Đăng nhập thành công!
            const user = result.user;
            
            // Lưu thông tin người dùng vào bộ nhớ máy (LocalStorage) để dùng cho Header
            const userInfo = {
                name: user.displayName,
                email: user.email,
                photo: user.photoURL
            };
            localStorage.setItem('user_info', JSON.stringify(userInfo));

            alert('Đăng nhập thành công: ' + user.displayName);
            window.location.href = "/"; // Quay về trang chủ
        })
        .catch((error) => {
            // Lỗi
            document.getElementById('login-message').innerText = "Lỗi: " + error.message;
            console.error(error);
        });
  });
</script>
{{ end }}